# In configurations/experiment/mujoco_video_generation.yaml
defaults:
  - base_pytorch_exp
  - _self_

exp_name: ${name}

dataset:
  _target_: datasets.video.mujoco.MujocoDataset
  name: mujoco
  save_dir: data/
  env_name: Reacher-v5
  resolution: 14
  external_cond_dim: 0
  max_frames: 16
  frame_skip: 1
  batch_size: 64
  num_workers: 4
  pin_memory: True

algorithm:
  _target_: algorithms.dfot.dfot_video.DFoTVideo
  name: dfot_video
  x_shape:
    - ${dataset.resolution}
    - 1
    - 1
  backbone:
    _target_: algorithms.dfot.backbones.u_net.u_net3d.UNet3DModel
    in_channels: ${dataset.resolution}
    out_channels: ${dataset.resolution}
    model_channels: 64
    num_res_blocks: 2
    attention_resolutions: []
    channel_mult: [1, 2, 4]
  logging:
    metrics:
      - mse
      - lpips
      - ssim
      - psnr
  diffusion:
    timesteps: 1000
    noise_schedule: "linear"
  optimizer:
    _target_: torch.optim.Adam
    lr: 1.0e-4

trainer:
  _target_: pytorch_lightning.Trainer
  accelerator: gpu
  devices: 1
  max_epochs: 1000
  log_every_n_steps: 10

cluster: null
paths:
  work_dir: ${hydra:runtime.cwd}
  output_dir: ${hydra:runtime.output_dir}
logger:
  _target_: pytorch_lightning.loggers.WandbLogger
  project: "online-df"
  name: ${exp_name}
  save_dir: "${paths.output_dir}"
callbacks:
  model_checkpoint:
    _target_: pytorch_lightning.callbacks.ModelCheckpoint
    dirpath: "${paths.output_dir}/checkpoints"
    filename: "epoch_{epoch:03d}"
    save_last: True
    auto_insert_metric_name: False
extras:
  ignore_warnings: False